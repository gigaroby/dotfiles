#!/usr/bin/env python3

import argparse
import boto3

def main():
    parser = argparse.ArgumentParser(description='get the hostname/ip of a ec2 instance')
    parser.add_argument('names', nargs='+', help='name of the machines')
    parser.add_argument('--private', help='get the private IP/DNS address', action='store_true')
    parser.add_argument('--ip', help='get the ip instead of DNS', action='store_true')
    parser.add_argument('--region', action='store', default='eu-west-1')
    parser.set_defaults(ip=False, private=False)
    args = parser.parse_args()

    ec2 = boto3.resource('ec2', region_name=args.region)
    instances = ec2.instances.filter(Filters=[{'Name': 'tag:Name', 'Values': args.names}])
    prefix = 'private' if args.private else 'public'
    suffix = 'ip_address' if args.ip else 'dns_name'
    for instance in instances:
        print(getattr(instance, prefix + '_' + suffix))


if __name__ == '__main__':
    main()
